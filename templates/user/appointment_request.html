{% extends "base.html" %}

{% block title %}Güncelleme Talebi{% endblock %}

{% block content %}
<section class="flex flex-col gap-4 sm:gap-6 lg:flex-row lg:items-end lg:justify-between">
    <div>
        <p class="text-xs uppercase tracking-[0.35em] text-slate-500">Güncelleme Talebi</p>
        <h1 class="mt-3 flex items-center gap-3 text-2xl font-semibold text-slate-100">
            <i class="bi bi-send-check text-emerald-400"></i>
            Randevu İçin Talep Oluştur
        </h1>
        <p class="mt-2 max-w-xl text-sm text-slate-400">Randevunuz düzenlemeye kapalıysa bu formu kullanarak yöneticiden
            güncelleme talep edebilirsiniz. Talebiniz değerlendirilip size geri dönüş yapılacaktır.</p>
    </div>
    <a href="{{ url_for('user_appointments') }}"
        class="inline-flex items-center gap-2 rounded-2xl border border-slate-800 bg-slate-900 px-5 py-3 text-sm font-semibold text-slate-300 transition hover:border-slate-700 hover:text-slate-100">
        <i class="bi bi-arrow-left"></i>
        Randevularım
    </a>
</section>

<div class="mt-6 grid gap-6 lg:grid-cols-[minmax(0,1.2fr)_minmax(0,0.8fr)]">
    <div class="rounded-3xl border border-slate-800/70 bg-slate-950/80 shadow-xl">
        <header class="flex items-center justify-between border-b border-slate-800/60 px-6 py-5">
            <div>
                <h2 class="flex items-center gap-2 text-sm font-semibold text-slate-200">
                    <i class="bi bi-chat-left-text text-lg text-sky-300"></i>
                    Talep Formu
                </h2>
                <p class="mt-1 text-xs text-slate-500">Randevu ID: #{{ appointment.id }}</p>
            </div>
        </header>
        <div class="px-6 py-6">
            <form method="POST" class="space-y-5">
                {{ form.hidden_tag() }}
                <div>
                    {{ form.reason.label(class_='text-sm font-medium text-slate-200') }}
                    {{ form.reason(class_='mt-2 min-h-[160px] w-full rounded-2xl border border-slate-800 bg-slate-950/80
                    px-4 py-3 text-sm text-slate-100 focus:border-amber-400 focus:outline-none focus:ring-2
                    focus:ring-amber-400/40') }}
                    <p class="mt-2 text-xs text-slate-500">Lütfen talebinizin detaylarını ve yöneticiye iletmek
                        istediğiniz tüm bilgileri ekleyin.</p>
                    {% if form.reason.errors %}
                    <p class="mt-2 text-xs text-red-300">{{ form.reason.errors[0] }}</p>
                    {% endif %}
                </div>
                <div class="flex flex-wrap gap-3">
                    <button type="submit"
                        class="inline-flex items-center gap-2 rounded-2xl border border-emerald-500/40 bg-emerald-500/10 px-5 py-3 text-sm font-semibold text-emerald-200 transition hover:bg-emerald-500/20">
                        <i class="bi bi-send"></i>
                        Talebi Gönder
                    </button>
                    <a href="{{ url_for('user_appointments') }}"
                        class="inline-flex items-center gap-2 rounded-2xl border border-slate-800 bg-slate-900 px-5 py-3 text-sm font-semibold text-slate-300 transition hover:border-slate-700 hover:text-slate-100">
                        <i class="bi bi-x-circle"></i>
                        İptal
                    </a>
                </div>
            </form>
        </div>
    </div>

    <aside class="space-y-4">
        <div class="rounded-3xl border border-slate-800/70 bg-slate-950/80 p-6 shadow-xl">
            <h3 class="flex items-center gap-2 text-sm font-semibold text-slate-200">
                <i class="bi bi-info-circle text-lg text-sky-300"></i>
                Randevu Özeti
            </h3>
            <dl class="mt-4 space-y-3 text-sm text-slate-300">
                <div class="flex items-start justify-between gap-4">
                    <dt class="text-slate-400">Ülke</dt>
                    <dd class="text-right">
                        <span class="flex items-center justify-end gap-2">
                            {% if appointment.country.flag_emoji %}<span>{{ appointment.country.flag_emoji }}</span>{%
                            endif %}
                            <span>{{ appointment.country.name }}</span>
                        </span>
                    </dd>
                </div>
                <div class="flex items-center justify-between gap-4">
                    <dt class="text-slate-400">Başvuran</dt>
                    <dd class="font-medium text-slate-200">{{ appointment.applicant_name }} {{
                        appointment.applicant_surname }}</dd>
                </div>
                <div class="flex items-center justify-between gap-4">
                    <dt class="text-slate-400">Pasaport</dt>
                    <dd>{{ appointment.passport_number }}</dd>
                </div>
                <div class="flex items-center justify-between gap-4">
                    <dt class="text-slate-400">Durum</dt>
                    <dd>
                        {% if appointment.status == 'Bekleme' %}
                        <span
                            class="inline-flex items-center rounded-full bg-amber-500/20 px-3 py-1 text-xs font-semibold text-amber-200">{{
                            appointment.status }}</span>
                        {% elif appointment.status == 'Süreç Başlatıldı' %}
                        <span
                            class="inline-flex items-center rounded-full bg-sky-500/20 px-3 py-1 text-xs font-semibold text-sky-200">{{
                            appointment.status }}</span>
                        {% elif appointment.status == 'Tamamlandı' %}
                        <span
                            class="inline-flex items-center rounded-full bg-emerald-500/20 px-3 py-1 text-xs font-semibold text-emerald-200">{{
                            appointment.status }}</span>
                        {% else %}
                        <span
                            class="inline-flex items-center rounded-full bg-red-500/20 px-3 py-1 text-xs font-semibold text-red-200">{{
                            appointment.status }}</span>
                        {% endif %}
                    </dd>
                </div>
                <div class="flex items-center justify-between gap-4">
                    <dt class="text-slate-400">Oluşturma</dt>
                    <dd>{{ appointment.created_at.strftime('%d.%m.%Y %H:%M') }}</dd>
                </div>
            </dl>
        </div>
        <div class="rounded-3xl border border-amber-500/40 bg-amber-500/10 p-6 text-xs text-amber-100">
            <h4 class="flex items-center gap-2 text-sm font-semibold">
                <i class="bi bi-exclamation-triangle"></i>
                Önemli Not
            </h4>
            <p class="mt-3">Talebiniz "Bekliyor" durumundayken aynı randevu için başka bir talep oluşturamazsınız.
                Yönetici talebinizi inceledikten sonra bilgilendirileceksiniz.</p>
        </div>
    </aside>
</div>
{% endblock %}